% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wspmm.R
\name{wisp}
\alias{wisp}
\title{Fit wisp to count data}
\usage{
wisp(
  count.data,
  variables = list(),
  use.median = FALSE,
  MCMC.settings = list(),
  bootstraps.num = 0,
  converged.resamples.only = TRUE,
  max.fork = 1,
  dim.bounds = c(),
  verbose = TRUE,
  print.child.summaries = TRUE,
  model.settings = list()
)
}
\arguments{
\item{count.data}{Data.frame, data to be modeled, with columns for model variables (count, bin, parent, child, ran, fixedeffects), or equivalent variables as specified in the \code{variables} argument.}

\item{variables}{List, names of the columns in \code{count.data} that correspond to the model variables. The list should contain only (but not necessarily all) named elements: \code{count}, \code{bin}, \code{parent}, \code{child}, \code{ran}, and \code{fixedeffects}.}

\item{use.median}{Logical, if TRUE, the median of the resamples is used as the final parameter estimates; if FALSE, the initial fit by L-BFGS is used.}

\item{MCMC.settings}{List, settings for the MCMC simulation, including \code{MCMC.burnin}, \code{MCMC.steps}, \code{MCMC.step.size}, \code{MCMC.prior}, and \code{MCMC.neighbor.filter}. Default values are provided.}

\item{bootstraps.num}{Integer, number of bootstrap resamples to perform. If 0, only MCMC is run.}

\item{converged.resamples.only}{Logical, if TRUE, only resamples with a converged fit are used for statistical analysis; if FALSE, all resamples are used. Applies only to bootstraps.}

\item{max.fork}{Integer, maximum number of parallel processes to use for bootstrapping.}

\item{dim.bounds}{Numeric vector, block boundaries for plotting in rate-count plots. If empty, the argument is ignored.}

\item{verbose}{Logical, if TRUE, prints information during the fitting process.}

\item{print.child.summaries}{Logical, if TRUE, prints summaries of each child level.}

\item{model.settings}{List, settings for the C++ model, including \code{buffer_factor}, \code{ctol}, \code{max_penalty_at_distance_factor}, \code{LROcutoff}, \code{LROwindow_factor}, \code{rise_threshold_factor}, \code{max_evals}, \code{rng_seed}, and \code{warp_precision}. Default values are provided.}
}
\value{
List giving the results of the fitted model, including: \code{model.component.list}, \code{count.data.summed}, \code{fitted.parameters}, \code{gamma.disperson}, \code{param.names}, \code{fix}, \code{treatment}, \code{grouping.variables}, \code{param.idx0}, \code{settings}, \code{sample.params}, \code{sample.params.bs}, \code{sample.params.MCMC}, \code{diagnostics.bs}, \code{diagnostics.MCMC}, \code{stats}, and \code{plots}
}
\description{
This function takes a data frame of wisp variables (as columns) and fits a wisp model to it. Statistical analyses and plots are generated from the fitted model.
}
