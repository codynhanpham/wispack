<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>RORB in barrel cortex ‚Ä¢ wispack</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="RORB in barrel cortex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wispack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Introduction</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Package Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Installation</h6></li>
    <li><a class="dropdown-item" href="../articles/install.html">Installation instructions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/example_2.html">Example 2</a></li>
    <li><a class="dropdown-item" href="../articles/example_corticallaminar_basic.html">RORB in barrel cortex</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Legal</h6></li>
    <li><a class="dropdown-item" href="../articles/license.html">Dependency licenses</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/michaelbarkasi/wispack"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../#">üåô</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>RORB in barrel cortex</h1>
            
      

      <div class="d-none name"><code>example_corticallaminar_basic.Rmd</code></div>
    </div>

    
    
<p>The gene RORB plays a key role in the development of sensorimotor
cortex in rodents. RORB expression leads axons from thalamic neurons to
innervate layer 4 of the cortex. These thalamocortical projections
organize into discrete ‚Äúbarrel‚Äù formations, each barrel containing the
inputs from neurons responsive to a single whisker.</p>
<p>While it‚Äôs generally assumed that there are no major differences
between barrel formations in the left and right hemispheres
(‚Äúlaterality‚Äù), over the years there have been several histological
studies suggesting age and sex-dependent hemispheric differences. Given
the established role of RORB in barrel formation, one might want to test
for age or sex-dependent laterality in RORB expression.</p>
<h1>
Preprocessing the raw data
</h1>
<p>To test for effects of laterality in RORB expression, this example
uses data collected from four male wild-type mice at two ages: postnatal
day 12 (P12) and postnatal day 18 (P18). We started with raw,
non-normalized mRNA counts from the cells within the primary
sensorimotor cortex (S1), both left and right hemispheres. Before using
any functions from wispack, we identified S1 in each sample by manually
fitting the entire slice to CCFv3 and then extracting the S1 region.</p>
<div class="figure">
<img src="fig_S1_Rorb.png" alt="Image of horizontal mouse brain slice with primary sensorimotor cortex highlight and second image of the laminar and columnar axes of the cortex" width="90%"><p class="caption">
Left: Example horizontal slice as reconstructed from MERFISH data. Red
highlight indicates the right primary sensorimotor cortex. Right: The
right sensorimotor cortex, with RORB molecules in red and laminar and
columnar axes labeled.
</p>
</div>
<p>As wisp can only model one dimension of spatial variation (at least,
as-of the writing of this demo for v1.0), we need to identify this axis
and transform the RORB molecule coordinates into it. As we are primarily
concerned with how RORB is distributed across cortical layers, the
laminar axis is the obviously candidate. Coordinate transformation into
an axis of interest must be done outside of wispack. For this case, we
wrote a custom coordinate transformation described in this <a href="https://doi.org/10.1101/2025.06.11.659209" class="external-link">preprint</a> and
available as code in this <a href="https://github.com/Oviedo-Lab/wspmm_methods.git" class="external-link">repo</a> (see
function cortical_coordinate_transform in script
merfish_preprocessing.R).</p>
<div class="figure">
<img src="fig_coordtrans.png" alt="Image showing the steps to transform coordinates from the CCFv3 registration to laminar and columnar axes" width="90%"><p class="caption">
Visualization of coordinate transform steps from initial CCFv3
registration to laminar and columnar axes.
</p>
</div>
<h1>
Loading the data
</h1>
<p>Wispack contains a csv file with the results of this coordinate
transformation applied to the raw data. To start, load this data and
print its first few rows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">countdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>, </span>
<span>    <span class="st">"S1_laminar_countdata_demo.csv"</span>, </span>
<span>    package <span class="op">=</span> <span class="st">"wispack"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">countdata</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   count bin cortex   gene mouse hemisphere age</span></span>
<span><span class="co">## 1     0 100 cortex Bcl11b     1       left  12</span></span>
<span><span class="co">## 2     0  99 cortex Bcl11b     1       left  12</span></span>
<span><span class="co">## 3     0  93 cortex Bcl11b     1       left  12</span></span>
<span><span class="co">## 4     0  98 cortex Bcl11b     1       left  12</span></span>
<span><span class="co">## 5     0  94 cortex Bcl11b     1       left  12</span></span>
<span><span class="co">## 6     0  94 cortex Bcl11b     1       left  12</span></span></code></pre>
<p>As can be seen, the imported data is a data frame with the columns:
count, bin, cortex, gene, mouse, hemisphere, age. Although we‚Äôre focused
on RORB, these first few rows show that there are other genes in the
data as well. How many?</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">countdata</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of genes:"</span>, <span class="va">num_genes</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Number of genes: 6</span></span></code></pre>
<p>Which genes?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gene names:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">countdata</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Gene names: Bcl11b, Fezf2, Satb2, Nxph3, Cux2, Rorb</span></span></code></pre>
<p>These additional genes are included for two reasons. First, just as
RORB is known to be localized to L4, the other genes are also known to
be localized to specific layers. So, the modeling results can be
compared to known biology in all cases. Second, including multiple genes
provides more implicit information for estimating things like random
effects, and thus helps to avoid overfitting to any one gene.</p>
<p>Each row in the data frame represents a cell from the left or right
S1 region of one of the four mice. Each cell being represented in
multiple rows, one row per gene. Hence, we can find the number of cells
by dividing by the number of genes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">countdata</span><span class="op">)</span><span class="op">/</span><span class="va">num_genes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of cells:"</span>, <span class="va">num_cells</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Number of cells: 54116</span></span></code></pre>
<p>Notice that the count column thus gives the number of molecules of
the RNA species listed in the gene column, found in the cell represented
by a given row. Each cell, of course, comes from a specific mouse and
brain hemisphere, information given in the correspondingly named
columns. The age column gives the age of the mouse.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Barkasi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
