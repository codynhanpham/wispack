<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Implements warped-sigmoid Poisson-process mixed-effects models (WSPmm) ‚Ä¢ wispack</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Implements warped-sigmoid Poisson-process mixed-effects models (WSPmm)">
<meta name="description" content="WSPmm are intended for hypothesis testing of spatially or temporally variable count data. They parameterize data in terms of blocks separated by transition points, each block having a process rate and each transition point having both a position and slope.">
<meta property="og:description" content="WSPmm are intended for hypothesis testing of spatially or temporally variable count data. They parameterize data in terms of blocks separated by transition points, each block having a process rate and each transition point having both a position and slope.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">wispack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html">Introduction</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="articles/tutorials.html">Tutorials</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/your/repo"><span class="fa fab fa-github"></span></a></li>
<li class="nav-item"><a class="nav-link" href="#">üåô</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="wispack">wispack<a class="anchor" aria-label="anchor" href="#wispack"></a>
</h1></div>
<p>Wispack (pronounced ‚Äúwisp package‚Äù or ‚Äúwisp pack‚Äù) is an R package for testing for between-group effects on spatial variation in spatial transcriptomics data. Unlike mere SVG testing (spatially variable gene) which only involves testing for spatial variation of gene expression within a group, wispack allows for testing whether a factor such as age or rearing conditions has a nonzero effect on spatial variation between groups differing on that factor.</p>
<p>Wispack performs this testing by first using change-point detection to find spatial variation in samples, then fitting a nonlinear mixed-effect model to the detected change points. The core of the nonlinear model is a parameterization of the found change-points as inflections in logistic functions representing gradients of gene expression change. Multiple change-points are handled by summing the component logistic functions into a ‚Äúpoly-sigmoid‚Äù function. Fixed effects (such as age or rearing conditions) are then modeled as effects on the underlying logistic parameters. Random (within group) effects are modeled as further nonlinear warping of the poly-sigmoid. Significance testing is performed on the effects through either bootstrapping or MCMC resampling.</p>
<p>Preprint: <a href="https://doi.org/10.1101/2025.06.11.659209" class="external-link uri">https://doi.org/10.1101/2025.06.11.659209</a></p>
<p>Copyright (C) 2025, Michael Barkasi <a href="mailto:barkasi@wustl.edu" class="email">barkasi@wustl.edu</a></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Clone and <code>cd</code> into this git repo</li>
<li>Make <code>build_install.sh</code> executable by running <code>chmod +x build_install.sh</code> in bash terminal<br>
</li>
<li>In terminal, run <code>./build_install.sh</code> to build and install the package<br>
</li>
<li>To ensure a clean start, run:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> src/<span class="pp">*</span>.o src/<span class="pp">*</span>.so  </span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-rf</span> wispack.Rcheck  </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-f</span> wispack_<span class="pp">*</span>.tar.gz  </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="ex">./build_install.sh</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="build-documentation">Build documentation<a class="anchor" aria-label="anchor" href="#build-documentation"></a>
</h2>
<p>In R, run: devtools::document() # regenerates .Rd files in man/ pkgdown::build_site()</p>
<div class="section level3">
<h3 id="linux">Linux<a class="anchor" aria-label="anchor" href="#linux"></a>
</h3>
<p>On Linux (Ubuntu/Debian), additional system dependencies are required <em>before</em> the building process: - <code>libxml2</code> for roxygen2 - <code>r-base-dev</code>, <code>libnlopt-dev</code> (or <code>libnlopt-cxx-dev</code>) for Rcpp, RcppEigen, and StanHeaders</p>
<p>For PDF documentation generation, <code>pdflatex</code> should also be installed</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="dt">\</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    libxml2 <span class="dt">\</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    r-base-dev <span class="dt">\</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    libnlopt-dev <span class="dt">\</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    libnlopt-cxx-dev <span class="dt">\</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    texlive-latex-base <span class="dt">\</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    texlive-fonts-recommended <span class="dt">\</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    texlive-fonts-extra <span class="dt">\</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    texlive-latex-extra</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="demos">Demos<a class="anchor" aria-label="anchor" href="#demos"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span><span class="st">"quick_start"</span>, package <span class="op">=</span> <span class="st">"wispack"</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/demo.html" class="external-link">demo</a></span><span class="op">(</span><span class="st">"full_options"</span>, package <span class="op">=</span> <span class="st">"wispack"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dependency-licenses">Dependency licenses<a class="anchor" aria-label="anchor" href="#dependency-licenses"></a>
</h2>
<p>NOTE: The GPLv2 of Rcpp and the Apache 2.0 of the oneTBB compiled with Stan are incompatible when bundled together as a single binary, which is why these scripts are being provided as a buildable R package on GitHub but not as a precompiled binary ready for installation.</p>
<p>See: <a href="https://github.com/stan-dev/stan/wiki/Stan-Licensing" class="external-link uri">https://github.com/stan-dev/stan/wiki/Stan-Licensing</a></p>
<table style="width:62%;" class="table">
<colgroup><col width="62%"></colgroup>
<thead><tr>
<th align="left">### Rcpp</th>
</tr></thead>
<tbody>
<tr>
<td align="left">### Stan Math</td>
</tr>
<tr>
<td align="left">Bob Carpenter <a href="https://bob-carpenter.github.io/" class="external-link uri">https://bob-carpenter.github.io/</a>
</td>
</tr>
<tr>
<td align="left">
<a href="https://mc-stan.org/math/" class="external-link uri">https://mc-stan.org/math/</a> <a href="https://github.com/stan-dev/math" class="external-link uri">https://github.com/stan-dev/math</a>
</td>
</tr>
<tr>
<td align="left">BSD 3-Clause License</td>
</tr>
<tr>
<td align="left">The Stan Math Library depends on the Intel TBB library which is licensed under the Apache 2.0 license. This dependency implies an additional restriction as compared to the new BSD license alone. The Apache 2.0 license is incompatible with GPL-2 licensed code if distributed as a unitary binary. You may refer to the Licensing page on the Stan wiki.</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="boost--bh">Boost / BH<a class="anchor" aria-label="anchor" href="#boost--bh"></a>
</h3>
<p>Copyright Beman Dawes, David Abrahams, 1998-2005.<br>
Copyright Rene Rivera 2004-2007.</p>
<p><a href="https://www.boost.org/" class="external-link uri">https://www.boost.org/</a><br><a href="https://github.com/boostorg" class="external-link uri">https://github.com/boostorg</a></p>
<p>Boost license 1.0<br><a href="https://www.boost.org/LICENSE_1_0.txt" class="external-link uri">https://www.boost.org/LICENSE_1_0.txt</a><br><a href="https://github.com/boostorg/boost/blob/master/LICENSE_1_0.txt" class="external-link uri">https://github.com/boostorg/boost/blob/master/LICENSE_1_0.txt</a></p>
<p>‚ÄúBoost Software License - Version 1.0 - August 17th, 2003</p>
<p>Permission is hereby granted, free of charge, to any person or organization obtaining a copy of the software and accompanying documentation covered by this license (the ‚ÄúSoftware‚Äù) to use, reproduce, display, distribute, execute, and transmit the Software, and to prepare derivative works of the Software, and to permit third-parties to whom the Software is furnished to do so, all subject to the following:</p>
<p>The copyright notices in the Software and this entire statement, including the above license grant, this restriction and the following disclaimer, must be included in all copies of the Software, in whole or in part, and all derivative works of the Software, unless such copies or derivative works are solely in the form of machine-executable object code generated by a source language processor.</p>
<p>THE SOFTWARE IS PROVIDED ‚ÄúAS IS‚Äù, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE FOR ANY DAMAGES OR OTHER LIABILITY, WHETHER IN CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.‚Äù</p>
<table style="width:62%;" class="table">
<colgroup><col width="62%"></colgroup>
<thead><tr>
<th align="left">### Eigen</th>
</tr></thead>
<tbody>
<tr>
<td align="left">### SUNDIALS</td>
</tr>
<tr>
<td align="left">Lawrence Livermore National Security and Southern Methodist University.</td>
</tr>
<tr>
<td align="left"><a href="https://computing.llnl.gov/projects/sundials" class="external-link uri">https://computing.llnl.gov/projects/sundials</a></td>
</tr>
<tr>
<td align="left">BSD 3-Clause License Copyright (c) 2002-2019</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="onetbb">oneTBB<a class="anchor" aria-label="anchor" href="#onetbb"></a>
</h3>
<p>Unified Acceleration (UXL) Foundation</p>
<p><a href="https://github.com/uxlfoundation/oneTBB" class="external-link uri">https://github.com/uxlfoundation/oneTBB</a></p>
<p>Apache 2.0<br><a href="https://github.com/uxlfoundation/oneTBB/blob/master/LICENSE.txt" class="external-link uri">https://github.com/uxlfoundation/oneTBB/blob/master/LICENSE.txt</a></p>
<table style="width:62%;" class="table">
<colgroup><col width="62%"></colgroup>
<thead><tr>
<th align="left">### nlopt</th>
</tr></thead>
<tbody>
<tr>
<td align="left">### pcg</td>
</tr>
<tr>
<td align="left">Melissa E. O‚ÄôNeill <a href="https://www.cs.hmc.edu/~oneill/index.html" class="external-link uri">https://www.cs.hmc.edu/~oneill/index.html</a>
</td>
</tr>
<tr>
<td align="left">
<a href="https://www.pcg-random.org/" class="external-link uri">https://www.pcg-random.org/</a> <a href="https://github.com/imneme/pcg-cpp" class="external-link uri">https://github.com/imneme/pcg-cpp</a>
</td>
</tr>
<tr>
<td align="left">Apache 2.0 and The MIT License</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="unistdh-part-of-the-c-posix-library">unistd.h, part of the C POSIX library<a class="anchor" aria-label="anchor" href="#unistdh-part-of-the-c-posix-library"></a>
</h3>
<p>The IEEE and The Open Group<br><a href="https://pubs.opengroup.org/onlinepubs/9799919799/" class="external-link uri">https://pubs.opengroup.org/onlinepubs/9799919799/</a><br><a href="https://www.opengroup.org/membership/forums/platform/unix" class="external-link uri">https://www.opengroup.org/membership/forums/platform/unix</a></p>
<p><a href="https://pubs.opengroup.org/onlinepubs/7908799/xsh/unistd.h.html" class="external-link uri">https://pubs.opengroup.org/onlinepubs/7908799/xsh/unistd.h.html</a></p>
<p>Available and licensed on your local system</p>
<table style="width:62%;" class="table">
<colgroup><col width="62%"></colgroup>
<tbody>
<tr>
<td align="left">### dtwclust</td>
</tr>
<tr>
<td align="left">Alexis Sarda-Espinosa Sarda-Espinosa A (2024). dtwclust: Time Series Clustering Along with Optimizations for the Dynamic Time Warping Distance. R package version 6.0.0</td>
</tr>
<tr>
<td align="left">Specifically using DTW Barycenter Averaging, from: Petitjean F, Ketterlin A and Gancarski P (2011). ‚ÄúA global averaging method for dynamic time warping, with applications to clustering.‚Äù Pattern Recognition, 44(3), pp.¬†678 - 693. ISSN 0031-3203, <a href="doi:10.1016/j.patcog.2010.09.013" class="uri">doi:10.1016/j.patcog.2010.09.013</a>, <a href="https://www.sciencedirect.com/science/article/pii/S003132031000453X" class="external-link uri">https://www.sciencedirect.com/science/article/pii/S003132031000453X</a>
</td>
</tr>
<tr>
<td align="left">
<a href="https://cran.r-project.org/package=dtwclust" class="external-link uri">https://cran.r-project.org/package=dtwclust</a> <a href="https://github.com/asardaes/dtwclust" class="external-link uri">https://github.com/asardaes/dtwclust</a>
</td>
</tr>
<tr>
<td align="left">GPLv3</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="ggplot2">ggplot2<a class="anchor" aria-label="anchor" href="#ggplot2"></a>
</h3>
<p>by: ggplot2 core developer team</p>
<p><a href="https://ggplot2.tidyverse.org/" class="external-link uri">https://ggplot2.tidyverse.org/</a></p>
<p>The MIT license<br><a href="https://github.com/tidyverse/ggplot2" class="external-link uri">https://github.com/tidyverse/ggplot2</a></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing wispack</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michael Barkasi <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Barkasi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
